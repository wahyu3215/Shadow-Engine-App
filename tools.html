<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHADOW | Tools (Remake)</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;550;600;700&display=swap" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    
    <style>
        /* --- 1. THEME VARIABLES --- */
        body[data-theme="elegant-dark"] {
            --bg-color: #000000; --text-color: #e0e0e0;
            --primary-color: #cccccc; --primary-glow: rgba(204, 204, 204, 0.3); 
            --border-color: #333; --input-bg: #1a1a1a;
            --container-bg: #000000; --menu-card-bg: #0a0a0a;
            --menu-card-bg-hover: #1a1a1a; --results-bg: #0a0a0a;
            --results-border: var(--primary-color);
            --danger-color: #ef4444; --success-color: #22c55e;
            --gray-color: #64748b;
        }
        body[data-theme="midnight-blue"] {
            --bg-color: #020617; --text-color: #e2e8f0;
            --primary-color: #38bdf8; --primary-glow: rgba(56, 189, 248, 0.3); 
            --border-color: #1e293b; --input-bg: #1e293b;
            --container-bg: #020617; --menu-card-bg: #0f172a;
            --menu-card-bg-hover: #1e293b; --results-bg: #0f172a;
            --results-border: var(--primary-color);
            --danger-color: #ef4444; --success-color: #22c55e;
            --gray-color: #64748b;
        }
        body[data-theme="light-mode"] {
            /* Adaptasi TT DL untuk Light Mode */
            --bg-color: #f1f5f9; --text-color: #0f172a;
            --primary-color: #0f172a; --primary-glow: rgba(15, 23, 42, 0.2); 
            --border-color: #cbd5e1; --input-bg: #ffffff;
            --container-bg: #f1f5f9; --menu-card-bg: #ffffff;
            --menu-card-bg-hover: #e2e8f0; --results-bg: #ffffff;
            --results-border: var(--primary-color);
            --danger-color: #dc2626; --success-color: #16a34a;
            --gray-color: #475569;
        }

        /* --- 2. GLOBAL STYLES --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color); color: var(--text-color);
            display: flex; justify-content: center; min-height: 100vh;
            overflow-x: hidden; flex-direction: column; padding: 0;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        /* --- 3. LAYOUT & HEADER --- */
        .video-header-container {
            position: relative; width: 100%; padding-top: 56.25%;
            overflow: hidden; background-color: #111;
            transition: height 0.3s ease, padding-top 0.3s ease;
        }
        body.hide-video .video-header-container { height: 0; padding-top: 0; }
        
        .video-header-container video {
            position: absolute; top: 0; left: 0;
            width: 100%; height: 100%; object-fit: cover;
        }
        .video-overlay {
            position: absolute; bottom: 0; left: 0; width: 100%;
            padding: 2.5rem 1.5rem 1rem 1.5rem;
            background: linear-gradient(to top, rgba(0,0,0,0.8), rgba(0,0,0,0)); 
            z-index: 2; transition: opacity 0.3s ease;
        }
        body.hide-overlay .video-overlay { opacity: 0; }
        
        .video-overlay p {
            font-size: 0.9rem; color: #cccccc; font-weight: 500;
            text-shadow: 0 0 5px rgba(0,0,0,0.5);
            max-width: 70%; /* FIX: Biar gak tabrakan */
        }
        
        .video-overlay-right {
            position: absolute;
            bottom: 1rem; right: 1.5rem; z-index: 3;
            font-family: 'Courier New', Courier, monospace;
            font-size: 1.1rem; font-weight: 700; color: #fff;
            text-shadow: 0 0 5px rgba(0,0,0,0.8);
            transition: opacity 0.3s ease;
        }
        body.hide-overlay .video-overlay-right { opacity: 0; }
        
        #settings-toggle-btn {
            position: fixed; top: 1rem; right: 1rem; z-index: 101;
            background: rgba(0,0,0,0.5); backdrop-filter: blur(5px);
            border: 1px solid var(--border-color); color: var(--primary-color);
            width: 40px; height: 40px; border-radius: 5px;
            font-size: 1.1rem; cursor: pointer; transition: all 0.3s ease;
        }
        #settings-toggle-btn:hover { background: var(--primary-color); color: var(--bg-color); }
        
        .container {
            width: 100%; max-width: 100%;
            background-color: var(--container-bg); 
            padding: 1.5rem; z-index: 10; margin-top: 0;
            border-radius: 0; border: none; box-shadow: none; 
            min-height: 100vh; transition: background-color 0.3s ease;
        }

        @media (min-width: 768px) {
            body { align-items: center; }
            .container {
                width: 100%; max-width: 900px; margin: 2rem auto;
                border-radius: 8px; border: 1px solid var(--border-color);
                box-shadow: 0 0 25px rgba(0, 0, 0, 0.8);
                min-height: auto; overflow: hidden;
            }
        }

        h2 {
            font-size: 2rem; text-align: center; margin-bottom: 2rem;
            font-weight: 700; color: var(--primary-color); margin-top: 1.5rem;
        }
        h3 {
             font-size: 1.5rem; color: var(--primary-color);
             border-bottom: 1px solid var(--border-color);
             padding-bottom: 5px; margin-bottom: 1.5rem;
        }
        h4 {
            font-size: 1.1rem; color: var(--primary-color);
            margin-top: 1.5rem; margin-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 5px;
        }
        p.tool-description {
            color: var(--text-color); opacity: 0.7; font-size: 0.9rem; 
            margin-bottom: 1.5rem; text-align: center;
        }
        
        /* --- 4. FORM & BUTTONS (UI UPGRADE) --- */
        .form-group { margin-bottom: 1.5rem; position: relative; }
        label, .form-label { display: block; margin-bottom: 0.75rem; font-weight: 500; color: var(--text-color); opacity: 0.9; }

        .form-control-container { position: relative; }
        
        input.form-control,
        textarea.form-control {
            width: 100%; padding: 1rem 1rem 1rem 3rem; font-size: 1rem;
            border-radius: 5px; border: 1px solid var(--border-color);
            background-color: var(--input-bg); color: var(--text-color);
            transition: all 0.3s ease; font-family: 'Poppins', sans-serif;
        }
        
        .input-icon {
            position: absolute; top: 50%; left: 1rem;
            transform: translateY(-50%); color: var(--gray-color);
            font-size: 1.1rem; transition: all 0.3s ease; z-index: 2;
        }
        
        input.form-control:focus + .input-icon,
        textarea.form-control:focus + .input-icon {
            color: var(--primary-color);
        }
        
        input[type="file"].form-control { padding: 0; }
        input[type="file"].form-control::-webkit-file-upload-button {
            background: var(--primary-color); color: var(--bg-color);
            border: none; padding: 1rem; font-weight: 600;
            border-top-left-radius: 5px; border-bottom-left-radius: 5px;
            cursor: pointer; transition: background 0.3s ease; margin-right: 1rem;
        }
        input[type="file"].form-control::file-selector-button {
            background: var(--primary-color); color: var(--bg-color);
            border: none; padding: 1rem; font-weight: 600;
            border-top-left-radius: 5px; border-bottom-left-radius: 5px;
            cursor: pointer; transition: background 0.3s ease; margin-right: 1rem;
        }
        input[type="file"].form-control::-webkit-file-upload-button:hover,
        input[type="file"].form-control::file-selector-button:hover { background: var(--primary-glow); color: var(--primary-color); }
        
        input[type="file"].form-control-icon { padding-left: 3rem; }
        input[type="file"].form-control-icon::-webkit-file-upload-button {
             margin-right: 0; padding: 1rem 0.5rem 1rem 3rem;
             border-radius: 0; border-top-left-radius: 5px; border-bottom-left-radius: 5px;
             text-indent: -100px;
        }
        input[type="file"].form-control-icon::file-selector-button {
             margin-right: 0; padding: 1rem 0.5rem 1rem 3rem;
             border-radius: 0; border-top-left-radius: 5px; border-bottom-left-radius: 5px;
        }

        textarea.form-control { min-height: 150px; padding-top: 1rem; }
        input.form-control:focus, textarea.form-control:focus {
            outline: none; border-color: var(--primary-color);
            box-shadow: 0 0 10px var(--primary-glow); 
        }

        button {
            width: 100%; padding: 0.9rem; font-size: 1rem;
            border-radius: 5px; background-color: var(--primary-color);
            color: var(--bg-color); border: 2px solid var(--primary-color);
            font-weight: 600; cursor: pointer; text-transform: uppercase;
            letter-spacing: 1px; transition: all 0.3s ease;
            display: inline-flex; /* Agar icon center */
            align-items: center; /* Agar icon center */
            justify-content: center; /* Agar icon center */
            gap: 8px; /* Jarak icon & teks */
        }
        button:hover:not(:disabled) {
            background-color: transparent; color: var(--primary-color);
            box-shadow: 0 0 15px var(--primary-glow); 
            transform: translateY(-2px);
        }
        button:disabled { background-color: #222; color: #555; border-color: #222; cursor: not-allowed; }
        button.secondary { 
            background: transparent; border: 1px solid var(--border-color); 
            color: var(--text-color); opacity: 0.7; font-weight: 500; 
        }
        button.secondary:hover:not(:disabled) { 
            background-color: transparent; color: var(--primary-color); 
            border-color: var(--primary-color); opacity: 1;
            box-shadow: none; transform: none; 
        }
        .back-button {
            width: auto; padding: 0.5rem 1rem; font-size: 0.9rem;
            text-transform: none; margin-bottom: 1.5rem; border-width: 1px;
        }
        button.copy-btn {
            width: auto; font-size: 0.8rem; padding: 5px 10px;
            text-transform: none; position: absolute; top: 1rem; right: 1rem;
            z-index: 5; background: #222; border-color: #444; color: #aaa;
        }
        
        .toggle-switch {
            display: flex; align-items: center; justify-content: space-between;
            background: var(--input-bg); padding: 0.8rem 1rem;
            border-radius: 5px; border: 1px solid var(--border-color);
            margin-bottom: 0.5rem;
        }
        .toggle-switch label { margin: 0; }
        .switch { position: relative; display: inline-block; width: 50px; height: 24px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #555; transition: .4s; border-radius: 24px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--primary-color); }
        input:checked + .slider:before { transform: translateX(26px); }
        
        /* Token Save/Reset (BARU) */
        .token-manager { display: flex; gap: 10px; align-items: center; margin-top: 10px; }
        .token-manager label { margin: 0; font-size: 0.9rem; display: flex; align-items: center; gap: 5px; }
        .token-manager button { width: auto; font-size: 0.9rem; padding: 5px 10px; text-transform: none; }

        /* --- 5. NOTIFICATION & PROGRESS --- */
        .notification { text-align: center; padding: 0.8rem; margin: 1rem 0; border-radius: 5px; display: none; font-size: 0.9rem; border: 1px solid; }
        .notification.success { background-color: #0f3d1b; color: #8affab; border-color: #1a7431; }
        .notification.error { background-color: #3d0f0f; color: #ffa8a8; border-color: #741a1a; }
        .notification.info { background-color: #0f2a3d; color: #a8dfff; border-color: #1a5674; }
        
        .progress-box {
            text-align: center; margin-top: 1.5rem; font-size: 1rem;
            color: var(--text-color); display: none;
        }
        .progress-bar {
            height: 8px; background: var(--input-bg);
            border-radius: 4px; overflow: hidden;
            margin-top: 1rem; position: relative;
        }
        .progress-bar div {
            height: 100%; background: var(--primary-color);
            width: 0%; transition: width 0.5s ease;
        }
        
        /* --- 6. MENU UTAMA (MODERN CARD) --- */
        #tools-menu { display: grid; grid-template-columns: 1fr; gap: 1rem; }
        @media (min-width: 600px) { #tools-menu { grid-template-columns: 1fr 1fr; gap: 1.5rem; } }
        .menu-card {
            display: flex; align-items: center;
            background-color: var(--menu-card-bg);
            border: 1px solid var(--border-color);
            color: var(--text-color); padding: 1.5rem;
            border-radius: 8px; text-decoration: none;
            transition: all 0.3s ease;
        }
        .menu-card:hover {
            background-color: var(--menu-card-bg-hover);
            border-color: var(--primary-color);
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            color: var(--primary-color);
        }
        .menu-card i {
            font-size: 1.5rem; color: var(--primary-color);
            width: 40px; text-align: center; margin-right: 1.5rem;
        }
        .menu-card span { font-size: 1.1rem; font-weight: 500; }
        
        /* --- 7. RESULTS & PANELS --- */
        .results-box {
            background: var(--results-bg); border-radius: 8px;
            padding: 1.5rem; margin-top: 1.5rem;
            border: 1px solid var(--border-color);
            border-left: 4px solid var(--results-border);
            display: none; position: relative;
        }
        .results-box h3 { margin-top: 0; border-bottom: none; }
        
        .results-list { list-style: none; padding: 0; margin-top: 1rem; }
        .results-list li {
            padding: 0.8rem 0; border-bottom: 1px solid var(--border-color);
            display: flex; justify-content: space-between; align-items: center;
        }
        .results-list li:last-child { border-bottom: none; }
        .results-list li strong {
            color: var(--primary-color); margin-right: 1rem;
            flex-shrink: 0;
        }
        .results-list li span { text-align: right; word-break: break-all; }
        .results-list li a { color: #22c55e; text-decoration: none; }
        .results-list li a:hover { text-decoration: underline; }
        
        .results-box pre {
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.95rem; color: var(--text-color);
            line-height: 1.8; margin-top: 1rem; background: var(--input-bg);
            padding: 1rem; border-radius: 5px; border: 1px solid var(--border-color);
            white-space: pre-wrap; word-break: normal; overflow-x: auto;
            max-height: 400px;
        }
        
        #ig-info-results img { border-radius: 50%; width: 120px; height: 120px; object-fit: cover; margin-top: 10px; border: 3px solid var(--primary-color); box-shadow: 0 0 15px var(--primary-glow); }
        #ig-info-results p { font-size: 1rem; color: var(--text-color); opacity: 0.8; margin: 0.5rem 0; line-height: 1.6; }
        #ig-info-results p b { color: var(--text-color); width: 100px; display: inline-block; text-align: right; margin-right: 10px; }
        
        #iqc-results img { width: 100%; max-width: 400px; border-radius: 8px; border: 1px solid var(--border-color); margin-top: 1rem; cursor: pointer; transition: transform 0.3s ease; }
        #iqc-results img:hover { transform: scale(1.02); }
        
        /* --- 8. MP3 PLAYER --- */
        #mp3-player { background: var(--menu-card-bg); border-radius: 8px; padding: 1.5rem; border: 1px solid var(--border-color); }
        #mp3-player canvas { width: 100%; height: 100px; background: var(--input-bg); border-radius: 5px; margin-bottom: 1rem; }
        .mp3-controls { display: flex; align-items: center; gap: 1rem; }
        #play-pause-btn { width: 50px; height: 50px; font-size: 1.2rem; padding: 0; border-radius: 50%; flex-shrink: 0; }
        #volume-slider { width: 100%; }
        #song-title { text-align: center; margin-top: 1rem; font-weight: 500; color: var(--text-color); opacity: 0.8; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        
        /* --- 9. ROBLOX STALKER STYLES --- */
        #roblox-form { display: flex; gap: 8px; flex-wrap: wrap; }
        #roblox-form .form-group { flex: 1; min-width: 200px; }
        #roblox-form button { width: auto; }
        #roblox-result { margin-top: 1.5rem; }
        .roblox-grid { display: grid; grid-template-columns: 120px 1fr; gap: 1.5rem; align-items: start; }
        .roblox-avatar {
            width: 120px; height: 120px; border-radius: 8px; background: var(--input-bg);
            display: flex; align-items: center; justify-content: center;
            overflow: hidden; border: 1px solid var(--border-color);
        }
        .roblox-avatar img { width: 100%; height: 100%; object-fit: cover; }
        .roblox-meta h4 { margin: 0; font-size: 1.3rem; color: var(--text-color); word-break: break-all; }
        .roblox-meta h4 small { color: var(--text-color); opacity: 0.7; }
        .roblox-meta p { margin: 6px 0; color: var(--text-color); opacity: 0.7; font-size: 0.9rem; }
        .roblox-stats { display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap; }
        .roblox-stat {
            background: var(--input-bg); border: 1px solid var(--border-color);
            padding: 8px 10px; border-radius: 8px; font-weight: 600;
            color: var(--text-color); opacity: 0.8; font-size: 0.9rem;
        }
        .roblox-groups { margin-top: 12px; }
        .roblox-groups h5 { margin: 10px 0 6px 0; color: var(--text-color); opacity: 0.7; font-weight: 600; }
        .roblox-groups div { font-size: 0.9rem; opacity: 0.9; margin-bottom: 4px; }
        .roblox-note { margin-top: 10px; color: var(--text-color); opacity: 0.7; font-size: 0.9rem; }
        .roblox-error { color: var(--danger-color); font-weight: 700; }
        .roblox-ok { color: var(--success-color); font-weight: 700; }
        details summary { cursor: pointer; color: var(--text-color); opacity: 0.7; margin-top: 1rem;}
        @media (max-width: 600px) {
            .roblox-grid { grid-template-columns: 1fr; gap: 1rem; }
            .roblox-avatar { width: 100%; height: 250px; }
        }
        
        /* --- 10. REMOVE BG --- */
        #rembg-results img {
            width: 100%; max-width: 500px; border-radius: 8px;
            border: 1px solid var(--border-color); margin-top: 1rem;
            background: repeating-conic-gradient(var(--input-bg) 0% 25%, var(--border-color) 0% 50%) 50% / 20px 20px;
        }

        /* --- 11. WEB2APK --- */
        #web2apk-upload-status {
            font-size: 0.9rem; margin-top: 0.75rem; padding: 0.5rem;
            border-radius: 0.5rem; transition: all 0.3s ease; display: none;
        }
        .status-success { background: rgba(34, 197, 94, 0.15); color: var(--success-color); }
        
        /* --- 12. DEPLOYER APK OPTIONS (BARU) --- */
        #deployer-apk-options {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-color);
            display: none; /* Sembunyi by default */
        }
        
        /* --- 13. SETTINGS PANEL --- */
        #settings-panel {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); backdrop-filter: blur(5px);
            z-index: 100; display: flex; justify-content: center; align-items: center;
            opacity: 0; visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        #settings-panel.active { opacity: 1; visibility: visible; }
        .settings-box {
            background: var(--menu-card-bg); padding: 2rem; border-radius: 8px;
            border: 1px solid var(--border-color); box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            width: 90%; max-width: 400px; position: relative;
            transform: translateX(50px); opacity: 0;
            transition: transform 0.3s cubic-bezier(0.23, 1, 0.32, 1), opacity 0.3s ease;
        }
        #settings-panel.active .settings-box { transform: translateX(0); opacity: 1; }
        .settings-box h3 { text-align: center; margin-top: 0; margin-bottom: 1.5rem; }
        .theme-switcher { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; }
        .theme-switcher button { text-transform: none; font-size: 0.9rem; padding: 0.8rem 0.5rem; font-weight: 500; }
        #close-settings-btn {
            position: absolute; top: 1rem; right: 1rem;
            width: 30px; height: 30px; padding: 0;
            font-size: 1rem; border-radius: 50%;
        }
        .settings-options { margin-top: 1.5rem; display: flex; flex-direction: column; gap: 0.5rem; }
        
        
        /* --- 14. TIKTOK DOWNLOADER STYLES (REMAKE) --- */
        
        /* Loading spinner disesuaikan dengan tema */
        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
        }
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--input-bg); /* Sesuai tema */
            border-left: 4px solid var(--primary-color); /* Sesuai tema */
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading p {
            color: var(--text-color);
            opacity: 0.8;
            margin-top: 10px;
        }

        /* Kontrol hasil di dalam .results-box */
        .video-info {
            text-align: center;
            margin-bottom: 20px;
        }
        .video-thumb {
            width: 100%;
            max-width: 300px;
            border-radius: 12px;
            margin: 0 auto 15px;
            display: block;
            border: 2px solid var(--border-color); /* Sesuai tema */
        }

        .video-title {
            font-size: 1.1rem;
            color: var(--text-color);
            opacity: 0.9;
            line-height: 1.4;
            font-weight: 500;
        }

        .download-options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }

        /* Tombol download hasil disesuaikan dengan tema */
        .option-btn {
            padding: 12px 20px;
            background: var(--input-bg); /* Sesuai tema */
            border: 1px solid var(--border-color); /* Sesuai tema */
            border-radius: 10px;
            color: var(--text-color); /* Sesuai tema */
            text-decoration: none;
            text-align: center;
            transition: all 0.3s ease;
            font-weight: 500;
            display: flex; /* Tambahan */
            align-items: center; /* Tambahan */
            justify-content: center; /* Tambahan */
            gap: 8px; /* Tambahan */
        }
        
        .option-btn:hover {
            background: var(--menu-card-bg-hover); /* Sesuai tema */
            color: var(--primary-color); /* Sesuai tema */
            border-color: var(--primary-color); /* Sesuai tema */
            transform: translateY(-2px);
        }
        
        /* --- 15. STYLE CUSTOM SELECT DROPDOWN (BARU) --- */
        .custom-select {
            position: relative;
        }
        .select-selected {
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: 5px;
            padding: 1rem 3rem 1rem 3rem; /* Pad left untuk icon, pad right untuk panah */
            font-size: 1rem;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .select-selected:hover {
            border-color: var(--primary-color);
        }
        .select-selected.select-arrow-active {
            border-color: var(--primary-color);
            box-shadow: 0 0 10px var(--primary-glow); 
        }
        /* Panah kustom */
        .select-selected::after {
            content: "";
            position: absolute;
            top: 50%;
            right: 1.25rem;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 6px solid var(--gray-color);
            transition: all 0.3s ease;
        }
        .select-selected.select-arrow-active::after {
            transform: translateY(-50%) rotate(180deg);
            border-top-color: var(--primary-color);
        }
        .select-items {
            position: absolute;
            background-color: var(--menu-card-bg);
            top: calc(100% + 4px);
            left: 0;
            right: 0;
            z-index: 99;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            max-height: 250px;
            overflow-y: auto;
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }
        /* Sembunyikan by default */
        .select-hide {
            display: none;
        }
        .select-items div {
            color: var(--text-color);
            padding: 0.9rem 1.2rem;
            cursor: pointer;
            transition: all 0.2s ease;
            border-bottom: 1px solid var(--border-color);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .select-items div:last-child {
            border-bottom: none;
        }
        .select-items div:hover {
            background-color: var(--menu-card-bg-hover);
            color: var(--primary-color);
        }
        /* Opsi yang terpilih di dalam list */
        .same-as-selected {
            background-color: var(--input-bg);
            font-weight: 500;
        }
        
        /* --- 16. STYLE SAVEWEB2ZIP VIEWER (BARU) --- */
        #saveweb-viewer {
            margin-top: 1.5rem;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            background: var(--input-bg);
        }
        #saveweb-viewer pre {
            margin-top: 0;
            border: none;
            background: transparent;
            box-shadow: none;
        }
        #saveweb-viewer img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 1rem;
            border-radius: 5px;
            border: 1px solid var(--border-color);
        }
        .zip-viewer-controls {
            display: flex;
            gap: 10px;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-color);
        }
        .zip-viewer-controls button, .zip-viewer-controls a {
            flex: 1;
            text-decoration: none;
            justify-content: center;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 0.8rem;
            font-size: 0.9rem;
        }

    </style>
</head>
<body data-theme="elegant-dark">

    <button id="settings-toggle-btn" title="Pengaturan">
        <i class="fas fa-swatchbook"></i>
    </button>
    
    <div class="container">
        
        <div class="video-header-container">
            <video autoplay muted loop playsinline src="https://files.catbox.moe/w6a76y.mp4">
                Browser Anda tidak mendukung tag video.
            </video>
            <div class="video-overlay">
                <p>Created & Developed by SHADOW</p>
            </div>
            <div class="video-overlay-right" id="live-clock">
                --:--:--
            </div>
        </div>
        
        <h2><i class="fas fa-tools"></i> Developer Tools</h2>

        <div id="tools-menu">
            <a href="#" class="menu-card" id="show-ip-tracker-btn">
                <i class="fas fa-map-marker-alt"></i>
                <span>Track IP Address</span>
            </a>
            <a href="#" class="menu-card" id="show-ig-info-btn">
                <i class="fab fa-instagram"></i>
                <span>Instagram Info Scraper</span>
            </a>
            <a href="#" class="menu-card" id="show-iqc-btn">
                <i class="fas fa-comment-dots"></i>
                <span>iPhone Quoted Chat</span>
            </a>
            <a href="#" class="menu-card" id="show-spotify-btn">
                <i class="fab fa-spotify"></i>
                <span>Spotify Downloader</span>
            </a>
            <a href="#" class="menu-card" id="show-mp3-btn">
                <i class="fas fa-music"></i>
                <span>MP3 Player</span>
            </a>
            <a href="#" class="menu-card" id="show-lunara-btn">
                <i class="fas fa-upload"></i>
                <span>Lunara File Uploader</span>
            </a>
            <a href="#" class="menu-card"id="show-roblox-btn">
                <i class="fas fa-gamepad"></i>
                <span>Roblox Stalker</span>
            </a>
            <a href="#" class="menu-card" id="show-rembg-btn">
                <i class="fas fa-wand-magic-sparkles"></i>
                <span>Remove Background</span>
            </a>
            <a href="#" class="menu-card" id="show-deployer-btn">
                <i class="fas fa-rocket"></i>
                <span>Web Deployer & Builder</span>
            </a>
            <a href="unband.html" class="menu-card">
                <i class="fas fa-unlock-alt"></i>
                <span>Jasa Unband WA</span>
            </a>
            <a href="#" class="menu-card" id="show-tiktok-btn">
                <i class="fab fa-tiktok"></i>
                <span>TikTok Downloader</span>
            </a>
            <a href="toolsv2.html" class="menu-card">
                <i class="fas fa-layer-group"></i>
                <span>Tools v2 (Beta)</span>
            </a>
            <a href="encryptor.html" class="menu-card">
                <i class="fas fa-key"></i>
                <span>Aphophis Encryptor</span>
            </a>
            </div>
        
        <div id="ip-tracker-panel" class="tool-panel" style="display: none;">
            <button class="secondary back-button"><i class="fas fa-chevron-left"></i> Kembali</button>
            <h3><i class="fas fa-map-marker-alt"></i> IP Address Tracker</h3>
            <p class="tool-description">Gunakan API dari ip-api.com untuk melacak lokasi.</p>
            <form id="ip-tracker-form">
                <div class="form-group">
                    <label class="form-label" for="ip-address">IP Address atau Domain</label>
                    <div class="form-control-container">
                        <i class="fas fa-network-wired input-icon"></i>
                        <input type="text" id="ip-address" class="form-control" placeholder="Contoh: 8.8.8.8 atau google.com" required>
                    </div>
                </div>
                <button type="submit" id="track-ip-btn"><i class="fas fa-search-location"></i> Lacak</button>
            </form>
            <div id="ip-tracker-notification" class="notification"></div>
            <div id="ip-tracker-results" class="results-box">
                <h3><i class="fas fa-info-circle"></i> Hasil Ditemukan</h3>
                <ul class="results-list" id="ip-results-list"></ul>
            </div>
        </div>
        
        <div id="ig-info-panel" class="tool-panel" style="display: none;">
            <button class="secondary back-button"><i class="fas fa-chevron-left"></i> Kembali</button>
            <h3><i class="fab fa-instagram"></i> Instagram Info Scraper</h3>
            <p class="tool-description">Ambil info user, stories, dan post publik.</p>
            <form id="ig-info-form">
                <div class="form-group">
                    <label class="form-label" for="username">Username Instagram</label>
                    <div class="form-control-container">
                        <i class="fab fa-instagram input-icon"></i>
                        <input type="text" id="username" class="form-control" placeholder="Masukkan username..." required>
                    </div>
                </div>
                <button type="submit" id="search-ig-btn"><i class="fas fa-search"></i> Cari Data</button>
            </form>
            <div id="ig-info-notification" class="notification"></div>
            <div id="ig-info-results" class="results-box" style="text-align: center;"></div>
        </div>
        
        <div id="iqc-panel" class="tool-panel" style="display: none;">
            <button class="secondary back-button"><i class="fas fa-chevron-left"></i> Kembali</button>
            <h3><i class="fas fa-comment-dots"></i> iPhone Quoted Chat</h3>
            <p class="tool-description">Buat gambar chat palsu iPhone (deteksi jam & baterai otomatis).</p>
            <form id="iqc-form">
                <div class="form-group">
                    <label class="form-label" for="iqc-text">Teks Pesan</label>
                    <div class="form-control-container">
                        <i class="fas fa-keyboard input-icon"></i>
                        <input type="text" id="iqc-text" class="form-control" placeholder="Contoh: Di Jual 500p Per ImageðŸ˜‹" required>
                    </div>
                </div>
                <button type="submit" id="generate-iqc-btn"><i class="fas fa-magic"></i> Buat</button>
            </form>
            <div id="iqc-notification" class="notification"></div>
            <div id="iqc-results" class="results-box" style="text-align: center;"></div>
        </div>
        
        <div id="spotify-panel" class="tool-panel" style="display: none;">
            <button class="secondary back-button"><i class="fas fa-chevron-left"></i> Kembali</button>
            <h3><i class="fab fa-spotify"></i> Spotify Downloader</h3>
            <p class="tool-description">Download lagu Spotify (track/playlist) via AceThinker API.</p>
            <form id="spotify-form">
                <div class="form-group">
                    <label class="form-label" for="spotify-url">URL Spotify</label>
                    <div class="form-control-container">
                        <i class="fab fa-spotify input-icon"></i>
                        <input type="text" id="spotify-url" class="form-control" placeholder="Masukkan URL Spotify..." required>
                    </div>
                </div>
                <button type="submit" id="spotify-dl-btn"><i class="fas fa-download"></i> Download</button>
            </form>
            <div id="spotify-notification" class="notification"></div>
            <div id="spotify-results" class="results-box">
                <h3><i class="fas fa-info-circle"></i> Hasil Ditemukan</h3>
                <ul class="results-list" id="spotify-results-list"></ul>
            </div>
        </div>
        
        <div id="mp3-panel" class="tool-panel" style="display: none;">
            <button class="secondary back-button"><i class="fas fa-chevron-left"></i> Kembali</button>
            <h3><i class="fas fa-music"></i> MP3 Player</h3>
            <div class="form-group">
                <label class="form-label" for="audio-upload">Upload Lagu (MP3/WAV/OGG)</label>
                <input type="file" id="audio-upload" class="form-control" accept="audio/*">
            </div>
            <div id="mp3-player">
                <canvas id="visualizer-canvas"></canvas>
                <div class="mp3-controls">
                    <button id="play-pause-btn"><i class="fas fa-play"></i></button>
                    <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="1">
                </div>
                <p id="song-title">Pilih file audio untuk diputar</p>
            </div>
            <audio id="audio-player" style="display: none;"></audio>
        </div>
        
        <div id="lunara-panel" class="tool-panel" style="display: none;">
            <button class="secondary back-button"><i class="fas fa-chevron-left"></i> Kembali</button>
            <h3><i class="fas fa-upload"></i> Lunara File Uploader</h3>
            <p class="tool-description">Upload gambar/video ke hosting gratis.</p>
            <form id="lunara-form">
                <div class="form-group">
                    <label class="form-label" for="lunara-file-input">Pilih File</label>
                    <input type="file" id="lunara-file-input" class="form-control" accept="image/*,video/*">
                </div>
                <div class="form-group">
                    <div class="toggle-switch">
                        <label for="lunara-permanent-check">Upload Permanen?</label>
                        <label class="switch">
                            <input type="checkbox" id="lunara-permanent-check" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <small style="opacity: 0.6; margin-top: 5px; display: block;">
                        (Centang = permanen, kosong = 24 jam)
                    </small>
                </div>
                <button type="submit" id="lunara-upload-btn"><i class="fas fa-cloud-upload-alt"></i> Upload</button>
            </form>
            <div id="lunara-notification" class="notification"></div>
            <div id="lunara-results" class="results-box">
                <h3><i class="fas fa-check-circle"></i> Berhasil Upload!</h3>
                <ul class="results-list" id="lunara-results-list"></ul>
            </div>
        </div>
        
        <div id="roblox-panel" class="tool-panel" style="display: none;">
            <button class="secondary back-button"><i class="fas fa-chevron-left"></i> Kembali</button>
            <h3><i class="fas fa-gamepad"></i> Roblox Stalker</h3>
            <p class="tool-description">Masukkan username Roblox untuk melihat info publik.</p>
            <form id="roblox-form">
                <div class="form-group" style="flex: 1;">
                    <label class="form-label" for="roblox-username">Username Roblox</label>
                    <div class="form-control-container">
                        <i class="fas fa-user-astronaut input-icon"></i>
                        <input type="text" id="roblox-username" class="form-control" placeholder="Contoh: nau_pangindo" autocomplete="off" required>
                    </div>
                </div>
                <div style="display: flex; gap: 8px; align-items: flex-end;">
                    <button type="submit" id="roblox-btn" style="width: auto;"><i class="fas fa-search"></i> Stalk</button>
                    <button type="button" id="roblox-clear-btn" class="secondary" style="width: auto;">Clear</button>
                </div>
            </form>
            <div id="roblox-notification" class="notification"></div>
            <div id="roblox-result" class="results-box" style="border: none; padding: 0;">
                <p class="roblox-note">Hasil akan muncul di sini setelah kamu klik <b>Stalk</b>.</p>
            </div>
        </div>
        
        <div id="rembg-panel" class="tool-panel" style="display: none;">
            <button class="secondary back-button"><i class="fas fa-chevron-left"></i> Kembali</button>
            <h3><i class="fas fa-wand-magic-sparkles"></i> Remove Background</h3>
            <p class="tool-description">Upload gambar untuk hapus background (via remove.bg API).</p>
            <form id="rembg-form">
                <div class="form-group">
                    <label class="form-label" for="rembg-api-key">Remove.bg API Key</label>
                    <div class="form-control-container">
                        <i class="fas fa-key input-icon"></i>
                        <input type="password" id="rembg-api-key" class="form-control" placeholder="Masukkan API Key Anda" required>
                    </div>
                    <small style="opacity: 0.6; margin-top: 5px; display: block;">
                        Daftar gratis di <a href="https://www.remove.bg/api" target="_blank" style="color: var(--primary-color);">remove.bg/api</a>
                    </small>
                </div>
                <div class="form-group">
                    <label class="form-label" for="rembg-file-input">Pilih Gambar</label>
                    <input type="file" id="rembg-file-input" class="form-control" accept="image/*" required>
                </div>
                <button type="submit" id="rembg-btn"><i class="fas fa-magic"></i> Hapus</button>
            </form>
            <div id="rembg-notification" class="notification"></div>
            <div id="rembg-results" class="results-box" style="text-align: center;">
                <h3><i class="fas fa-check-circle"></i> Hasil Gambar</h3>
                <img id="rembg-result-img" alt="Hasil remove background">
                <p style="margin-top: 1rem; opacity: 0.7;">Klik kanan / tahan gambar untuk menyimpan.</p>
            </div>
        </div>
        
        <div id="deployer-panel" class="tool-panel" style="display: none;">
            <button class="secondary back-button"><i class="fas fa-chevron-left"></i> Kembali</button>
            <h3><i class="fas fa-rocket"></i> Web Deployer & Builder</h3>
            <p class="tool-description">Deploy web statis ke Vercel & (opsional) build jadi APK.</p>
            <form id="deployer-form">
                <h4><i class="fas fa-server"></i> 1. Pengaturan Deploy</h4>
                <div class="form-group">
                    <label class="form-label" for="vercel-token">Vercel API Token</label>
                    <div class="form-control-container">
                        <i class="fas fa-key input-icon"></i>
                        <input type="password" id="vercel-token" class="form-control" placeholder="Token Vercel (wkaV...)" required>
                    </div>
                    <div class="token-manager">
                        <label>
                            <input type="checkbox" id="save-token-check"> Simpan Token
                        </label>
                        <button type="button" id="reset-token-btn" class="secondary" style="margin-left: auto;">Reset</button>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label" for="site-name">Nama Project Vercel</label>
                    <div class="form-control-container">
                        <i class="fas fa-file-signature input-icon"></i>
                        <input type="text" id="site-name" class="form-control" placeholder="contoh: web-keren-saya" required>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label" for="deployer-file-input">File (index.html atau .zip)</label>
                    <input type="file" id="deployer-file-input" class="form-control" accept=".html,.zip" required>
                </div>
                
                <h4><i class="fab fa-android"></i> 2. Opsi Build APK (Opsional)</h4>
                <div class="form-group">
                    <div class="toggle-switch">
                        <label for="deployer-build-apk-check">Build APK dari Web ini?</label>
                        <label class="switch">
                            <input type="checkbox" id="deployer-build-apk-check">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                
                <div id="deployer-apk-options">
                    <div class="form-group">
                        <label class="form-label" for="deployer-appName">Nama Aplikasi</label>
                        <div class="form-control-container">
                            <i class="fas fa-mobile-alt input-icon"></i>
                            <input type="text" id="deployer-appName" class="form-control" placeholder="MyApp">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="deployer-iconUrl">Icon URL</label>
                        <div class="form-control-container">
                            <i class="fas fa-image input-icon"></i>
                            <input type="text" id="deployer-iconUrl" class="form-control" placeholder="https://example.com/icon.png">
                        </div>
                        <small style="opacity: 0.6; margin-top: 5px; display: block;">
                            (Kosongkan jika di dalam .zip sudah ada `app.jpg` atau `app.png`)
                        </small>
                    </div>
                </div>
                
                <button type="submit" id="deployer-btn"><i class="fas fa-cloud-upload-alt"></i> Deploy Sekarang</button>
            </form>
            <div id="deployer-notification" class="notification"></div>
            <div id="deployer-results" class="results-box">
                <h3><i class="fas fa-check-circle"></i> Hasil Deploy</h3>
                <ul class="results-list" id="deployer-results-list"></ul>
            </div>
        </div>
        
        <div id="tiktok-panel" class="tool-panel" style="display: none;">
            <button class="secondary back-button"><i class="fas fa-chevron-left"></i> Kembali</button>
            
            <h3><i class="fab fa-tiktok"></i> TikTok Downloader</h3>
            <p class="tool-description">Copyright By @GyzenVtx</p>
            
            <form id="tiktok-form">
                <div class="form-group" style="margin-bottom: 1.5rem;"> <label class="form-label" for="tiktok-url">URL TikTok</label>
                    <div class="form-control-container">
                        <i class="fab fa-tiktok input-icon"></i> <input 
                            type="text" 
                            id="tiktok-url" 
                            class="form-control" /* Input standar */
                            placeholder="Tempel URL TikTok"
                        >
                    </div>
                </div>
        
                <button type="submit" id="tiktok-btn">
                    <i class="fas fa-download"></i>
                    Download
                </button>
            </form>

            <div id="tiktok-loading" class="loading">
                <div class="loading-spinner"></div>
                <p>Mengunduh video...</p>
            </div>
            
            <div id="tiktok-notification" class="notification"></div>

            <div id="tiktok-result" class="results-box">
                <div class="video-info">
                    <img id="tiktok-thumb" class="video-thumb" src="" alt="Video Thumbnail">
                    <h4 id="tiktok-title" class="video-title"></h4> </div>
                <div class="download-options">
                    <a id="tiktok-hd" href="#" class="option-btn" target="_blank" download>
                        <i class="fas fa-video"></i> Download HD
                    </a>
                    <a id="tiktok-sd" href="#" class="option-btn" target="_blank" download>
                        <i class="fas fa-video-slash"></i> Download SD
                    </a>
                    <a id="tiktok-mp3" href="#" class="option-btn" target="_blank" download>
                        <i class="fas fa-music"></i> Download MP3
                    </a>
                </div>
            </div>
        </div>
        <div class="dev-footer" style="text-align: center; border-top: 1px solid var(--border-color); padding-top: 2rem; margin-top: 2.5rem;">
            <h3><i class="fas fa-code"></i> Developer Info</h3>
            <p style="opacity: 0.7; font-size: 0.9rem; margin-bottom: 1.5rem; max-width: 600px; margin-left: auto; margin-right: auto;">
                Dibuat & Dikembangkan oleh SHADOW. <br>
                Jika menemukan error atau bug, jangan ragu untuk melapor.
            </p>
            <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                <a href="https://t.me/WahyzMaybe" target="_blank" class="menu-card" style="width: auto; padding: 0.8rem 1.2rem; text-decoration: none; flex: 1; min-width: 150px; margin-bottom: 0;">
                    <i class="fab fa-whatsapp"></i>
                    <span>Lapor Bug (WA)</span>
                </a>
                <a href="unband.html" class="menu-card" style="width: auto; padding: 0.8rem 1.2rem; text-decoration: none; flex: 1; min-width: 150px; margin-bottom: 0;">
                    <i class="fas fa-unlock-alt"></i>
                    <span>Jasa Unband WA</span>
                </a>
            </div>
        </div>
        
    </div>
    
    <div id="settings-panel">
        <div class="settings-box">
            <button id="close-settings-btn" class="secondary"><i class="fas fa-times"></i></button>
            <h3><i class="fas fa-swatchbook"></i> Ganti Tema</h3>
            <div class="theme-switcher">
                <button data-theme="elegant-dark">Elegant Dark</button>
                <button data-theme="midnight-blue">Midnight Blue</button>
                <button data-theme="light-mode">Light Mode</button>
            </div>
            <h3 style="margin-top: 2rem;"><i class="fas fa-cog"></i> Opsi Tampilan</h3>
            <div class="settings-options">
                <div class="toggle-switch">
                    <label for="toggle-video">Video Header</label>
                    <label class="switch">
                        <input type="checkbox" id="toggle-video">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="toggle-switch">
                    <label for="toggle-overlay">Info Overlay Video</label>
                    <label class="switch">
                        <input type="checkbox" id="toggle-overlay">
                        <span class="slider"></span>
                    </label>
                </div>
                <button id="reset-settings-btn" class="secondary" style="margin-top: 1rem;">Reset Pengaturan</button>
            </div>
        </div>
    </div>

    <script>
        /* --- 1. HELPER FUNCTIONS --- */
        
        function showNotification(id, message, type) {
            const el = document.getElementById(id);
            if (!el) return;
            el.textContent = message;
            el.className = 'notification ' + type;
            el.style.display = 'block';
        }

        function disableButton(btn) {
            if (!btn) return;
            btn.disabled = true;
            btn.setAttribute('data-original-text', btn.innerHTML);
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Loading...';
        }

        function enableButton(btn, text) {
            if (!btn) return;
            btn.disabled = false;
            const originalText = btn.getAttribute('data-original-text');
            if (text) { btn.innerHTML = text; } 
            else if (originalText) { btn.innerHTML = originalText; }
            else { btn.textContent = "Button"; }
        }
        
        function copyToClipboard(text, btn) {
            navigator.clipboard.writeText(text).then(() => {
                const oldText = btn.textContent;
                btn.textContent = 'Tersalin!';
                btn.disabled = true;
                setTimeout(() => {
                    btn.textContent = oldText;
                    btn.disabled = false;
                }, 2000);
            }).catch(err => { console.error('Gagal menyalin:', err); });
        }
        
        function addCopyButton(resultsBox, textToCopy) {
            const oldBtn = resultsBox.querySelector('.copy-btn');
            if (oldBtn) oldBtn.remove();
            const copyBtn = document.createElement('button');
            copyBtn.textContent = 'Copy';
            copyBtn.className = 'copy-btn';
            copyBtn.onclick = () => copyToClipboard(textToCopy, copyBtn);
            resultsBox.prepend(copyBtn);
        }
        
        function escapeHtml(s){
          if (s === null || s === undefined) return '';
          return String(s)
            .replace(/&/g,'&amp;')
            .replace(/</g,'&lt;')
            .replace(/>/g,'&gt;')
            .replace(/"/g,'&quot;')
            .replace(/'/g,'&#39;');
        }
        
        // Helper untuk download file dari blob (BARU)
        function downloadBlob(blob, filename) {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        /* --- 2. LOGIKA NAVIGASI, TEMA, SETTINGS --- */
        
        document.addEventListener('DOMContentLoaded', () => {
            const mainContent = {
                video: document.querySelector('.video-header-container'),
                h2: document.querySelector('h2'),
                menu: document.getElementById('tools-menu')
            };
            
            // Panel tools
            const panels = {
                ip: document.getElementById('ip-tracker-panel'),
                ig: document.getElementById('ig-info-panel'),
                iqc: document.getElementById('iqc-panel'),
                spotify: document.getElementById('spotify-panel'),
                mp3: document.getElementById('mp3-panel'),
                lunara: document.getElementById('lunara-panel'),
                roblox: document.getElementById('roblox-panel'),
                rembg: document.getElementById('rembg-panel'),
                deployer: document.getElementById('deployer-panel'),
                tiktok: document.getElementById('tiktok-panel')
            };
            
            // Tombol menu
            const buttons = {
                showIp: document.getElementById('show-ip-tracker-btn'),
                showIg: document.getElementById('show-ig-info-btn'),
                showIqc: document.getElementById('show-iqc-btn'),
                showSpotify: document.getElementById('show-spotify-btn'),
                showMp3: document.getElementById('show-mp3-btn'),
                showLunara: document.getElementById('show-lunara-btn'),
                showRoblox: document.getElementById('show-roblox-btn'),
                showRembg: document.getElementById('show-rembg-btn'),
                showDeployer: document.getElementById('show-deployer-btn'),
                showTiktok: document.getElementById('show-tiktok-btn')
                // Tombol toolsv2.html adalah link langsung, jadi tidak perlu JS
            };
            
            const backButtons = document.querySelectorAll('.back-button');
            const settingsPanel = document.getElementById('settings-panel');
            const settingsToggleBtn = document.getElementById('settings-toggle-btn');
            const closeSettingsBtn = document.getElementById('close-settings-btn');
            
            function showMainContent(visible) {
                const display = visible ? 'block' : 'none';
                if (mainContent.video) mainContent.video.style.display = display;
                if (mainContent.h2) mainContent.h2.style.display = display;
                if (mainContent.menu) mainContent.menu.style.display = visible ? 'grid' : 'none';
                
                // BARU: Tampilkan/sembunyikan tombol "View More" bersama menu
                const viewMoreBtn = document.getElementById('view-more-tools-btn');
                if (viewMoreBtn) {
                    viewMoreBtn.style.display = visible ? 'block' : 'none';
                }
            }
            
            function showPanel(panel) {
                showMainContent(false);
                Object.values(panels).forEach(p => p.style.display = 'none');
                panel.style.display = 'block';
            }
            
            buttons.showIp.addEventListener('click', (e) => { e.preventDefault(); showPanel(panels.ip); });
            buttons.showIg.addEventListener('click', (e) => { e.preventDefault(); showPanel(panels.ig); });
            buttons.showIqc.addEventListener('click', (e) => { e.preventDefault(); showPanel(panels.iqc); });
            buttons.showSpotify.addEventListener('click', (e) => { e.preventDefault(); showPanel(panels.spotify); });
            buttons.showMp3.addEventListener('click', (e) => { e.preventDefault(); showPanel(panels.mp3); });
            buttons.showLunara.addEventListener('click', (e) => { e.preventDefault(); showPanel(panels.lunara); });
            buttons.showRoblox.addEventListener('click', (e) => { e.preventDefault(); showPanel(panels.roblox); });
            buttons.showRembg.addEventListener('click', (e) => { e.preventDefault(); showPanel(panels.rembg); });
            buttons.showDeployer.addEventListener('click', (e) => { e.preventDefault(); showPanel(panels.deployer); });
            buttons.showTiktok.addEventListener('click', (e) => { e.preventDefault(); showPanel(panels.tiktok); });

            function backToMenu() {
                Object.values(panels).forEach(p => p.style.display = 'none');
                showMainContent(true);
                history.pushState("", document.title, window.location.pathname + window.location.search);
            }
            backButtons.forEach(btn => btn.addEventListener('click', backToMenu));
            
            // --- Logika View More Tools ---
            (function() {
                const toolsMenu = document.getElementById('tools-menu');
                if (!toolsMenu) return;
                const tools = toolsMenu.querySelectorAll('.menu-card');
                const MAX_VISIBLE_TOOLS = 6; // Tampilkan 6 item pertama

                if (tools.length > MAX_VISIBLE_TOOLS) {
                    // Sembunyikan tool yang lebih
                    for (let i = MAX_VISIBLE_TOOLS; i < tools.length; i++) {
                        tools[i].style.display = 'none';
                        tools[i].classList.add('hidden-tool');
                    }

                    // Buat dan masukkan tombol "View More"
                    const viewMoreBtn = document.createElement('button');
                    viewMoreBtn.id = 'view-more-tools-btn';
                    viewMoreBtn.className = 'secondary';
                    viewMoreBtn.style.cssText = 'width: 100%; grid-column: 1 / -1; margin-top: 1rem;';
                    viewMoreBtn.innerHTML = '<i class="fas fa-chevron-down"></i> Tampilkan Lebih Banyak';
                    toolsMenu.insertAdjacentElement('afterend', viewMoreBtn);

                    // Tambahkan listener klik
                    viewMoreBtn.addEventListener('click', () => {
                        const isShowingAll = viewMoreBtn.dataset.showingAll === 'true';
                        
                        tools.forEach((tool, index) => {
                            if (index >= MAX_VISIBLE_TOOLS) {
                                // Ganti display dari none ke flex (karena .menu-card pakai flex)
                                tool.style.display = isShowingAll ? 'none' : 'flex';
                            }
                        });

                        if (isShowingAll) {
                            viewMoreBtn.innerHTML = '<i class="fas fa-chevron-down"></i> Tampilkan Lebih Banyak';
                            viewMoreBtn.dataset.showingAll = 'false';
                        } else {
                            viewMoreBtn.innerHTML = '<i class="fas fa-chevron-up"></i> Tampilkan Lebih Sedikit';
                            viewMoreBtn.dataset.showingAll = 'true';
                        }
                    });
                }
            })();
            
            // --- Logika Settings Panel ---
            function openSettings() { settingsPanel.classList.add('active'); }
            function closeSettings() { settingsPanel.classList.remove('active'); }
            
            settingsToggleBtn.addEventListener('click', openSettings);
            closeSettingsBtn.addEventListener('click', closeSettings);
            settingsPanel.addEventListener('click', (e) => {
                if (e.target === settingsPanel) { closeSettings(); }
            });
            
            const themeSwitcher = document.querySelector('.theme-switcher');
            themeSwitcher.addEventListener('click', (e) => {
                if (e.target.tagName === 'BUTTON') {
                    const theme = e.target.dataset.theme;
                    document.body.dataset.theme = theme;
                    localStorage.setItem('xvct-theme', theme);
                    closeSettings();
                }
            });
            
            const toggleVideo = document.getElementById('toggle-video');
            const toggleOverlay = document.getElementById('toggle-overlay');
            const resetSettingsBtn = document.getElementById('reset-settings-btn');
            function applySettings() {
                const hideVideo = localStorage.getItem('xvct-hide-video') === 'true';
                const hideOverlay = localStorage.getItem('xvct-hide-overlay') === 'true';
                toggleVideo.checked = hideVideo;
                toggleOverlay.checked = hideOverlay;
                document.body.classList.toggle('hide-video', hideVideo);
                document.body.classList.toggle('hide-overlay', hideOverlay);
            }
            function loadThemeAndSettings() {
                const savedTheme = localStorage.getItem('xvct-theme');
                if (savedTheme) { document.body.dataset.theme = savedTheme; }
                applySettings();
            }
            toggleVideo.addEventListener('change', () => {
                localStorage.setItem('xvct-hide-video', toggleVideo.checked);
                applySettings();
            });
            toggleOverlay.addEventListener('change', () => {
                localStorage.setItem('xvct-hide-overlay', toggleOverlay.checked);
                applySettings();
            });
            resetSettingsBtn.addEventListener('click', () => {
                localStorage.removeItem('xvct-theme');
                localStorage.removeItem('xvct-hide-video');
                localStorage.removeItem('xvct-hide-overlay');
                document.body.dataset.theme = 'elegant-dark';
                applySettings();
                loadThemeAndSettings();
                closeSettings();
            });
            loadThemeAndSettings();
            showMainContent(true);

            // --- Logika Jam ---
            const clockEl = document.getElementById('live-clock');
            function updateTime() {
                const d = new Date(new Date().getTime() + 7*3600000); 
                const h = d.getUTCHours().toString().padStart(2, '0');
                const m = d.getUTCMinutes().toString().padStart(2, '0');
                const s = d.getUTCSeconds().toString().padStart(2, '0');
                if (clockEl) clockEl.textContent = `${h}:${m}:${s}`;
            }
            updateTime();
            setInterval(updateTime, 1000);
            
            // --- Logika Kustom Dropdown (Dapat dipakai di banyak tempat) ---
            function initCustomSelect(selectId) {
                const customSelect = document.getElementById(selectId);
                if (!customSelect) return;
                
                const selEl = customSelect.querySelector('.select-selected');
                const itemsEl = customSelect.querySelector('.select-items');
                
                // Toggle buka/tutup
                selEl.addEventListener('click', function(e) {
                    e.stopPropagation();
                    // Tutup semua dropdown lain dulu
                    closeAllSelects(selEl);
                    itemsEl.classList.toggle('select-hide');
                    selEl.classList.toggle('select-arrow-active');
                });
            }
            
            function closeAllSelects(exceptThis) {
                const allSelectItems = document.querySelectorAll('.select-items');
                const allSelectSelecteds = document.querySelectorAll('.select-selected');
                
                allSelectItems.forEach((items, i) => {
                    if (allSelectSelecteds[i] !== exceptThis) {
                        items.classList.add('select-hide');
                        allSelectSelecteds[i].classList.remove('select-arrow-active');
                    }
                });
            }
            // Klik di luar untuk menutup
            document.addEventListener('click', closeAllSelects);


            /* --- 3. LOGIKA FITUR-FITUR --- */

            // ... (Semua logika fitur 3.1 s/d 3.9 tetap di sini) ...
            
            // --- 3.1. IP Tracker ---
            (function() {
                const ipTrackerForm = document.getElementById('ip-tracker-form');
                if (!ipTrackerForm) return;
                const trackIpBtn = document.getElementById('track-ip-btn');
                const ipAddressInput = document.getElementById('ip-address');
                const ipNotif = document.getElementById('ip-tracker-notification');
                const ipResults = document.getElementById('ip-tracker-results');
                const ipResultsList = document.getElementById('ip-results-list');
                ipTrackerForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    ipNotif.style.display = 'none'; ipResults.style.display = 'none';
                    disableButton(trackIpBtn);
                    const ipAddress = ipAddressInput.value.trim();
                    if (!ipAddress) { showNotification('ip-tracker-notification', 'IP atau Domain tidak boleh kosong.', 'error'); enableButton(trackIpBtn); return; }
                    try {
                        const response = await fetch(`https://ip-api.com/json/${ipAddress}`);
                        const data = await response.json();
                        if (data.status !== "success") {
                            showNotification('ip-tracker-notification', `IP tidak valid atau tidak ditemukan! (Pesan: ${data.message})`, 'error');
                        } else {
                            ipResultsList.innerHTML = `
                                <li><strong>Query:</strong> <span>${data.query}</span></li>
                                <li><strong>ISP:</strong> <span>${data.isp}</span></li>
                                <li><strong>Organisasi:</strong> <span>${data.org}</span></li>
                                <li><strong>Kota:</strong> <span>${data.city}</span></li>
                                <li><strong>Region:</strong> <span>${data.regionName}</span></li>
                                <li><strong>Negara:</strong> <span>${data.country} (${data.countryCode})</span></li>
                                <li><strong>Timezone:</strong> <span>${data.timezone}</span></li>
                                <li><strong>Koordinat:</strong> <span>${data.lat}, ${data.lon}</span></li>
                                <li><strong>ASN:</strong> <span>${data.as}</span></li>
                            `;
                            ipResults.style.display = 'block';
                            const copyText = Object.entries(data).map(([key, value]) => `${key}: ${value}`).join('\n');
                            addCopyButton(ipResults, copyText);
                        }
                    } catch (err) {
                        showNotification('ip-tracker-notification', `Terjadi kesalahan saat menghubungi API.`, 'error');
                    } finally {
                        enableButton(trackIpBtn);
                    }
                });
            })();
            
            // --- 3.2. Instagram Info Scraper ---
            (function() {
                const igInfoForm = document.getElementById('ig-info-form');
                if (!igInfoForm) return;
                const proxy = "https://api.allorigins.win/raw?url=";
                const searchIgBtn = document.getElementById('search-ig-btn');
                const usernameInput = document.getElementById('username');
                const igNotif = document.getElementById('ig-info-notification');
                const igResults = document.getElementById('ig-info-results');
                async function getUser(usrname) {
                    const headers = { 'User-Agent': 'Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Mobile Safari/537.36', 'Referer': 'https://story-viewer.co/' };
                    const base = 'https://api.story-viewer.co';
                    const udata = (await axios.get(proxy + encodeURIComponent(`${base}/user/${usrname}?sig=4=eX9raGd4Jm94eWZ/Oi4zPz44OzI8Mj0/OzAtMT`), { headers })).data;
                    if (!udata || !udata.id) { throw new Error(udata.message || "User data tidak bisa diambil."); }
                    const [hdata, sdata, pdata] = await Promise.all([
                        axios.get(proxy + encodeURIComponent(`${base}/highlights/${udata.id}?sig=pOT01CSkxDSUdJCFMPHBcSExIcEx1XS0hCT0pPTUNDTkpMLUIzMT`), { headers }).then(res => res.data),
                        axios.get(proxy + encodeURIComponent(`${base}/stories/${usrname}?sig=egtaaxpri5p/2xprC7p6D45+Lg5uXg4uzs4eXjLeEyMj`), { headers }).then(res => res.data),
                        axios.get(proxy + encodeURIComponent(`${base}/posts/${usrname}?sig=pAGjtbKyvaP8pK+joLT86ODo4+Hk5ujo5eHnLeA4Mj`), { headers }).then(res => res.data)
                    ]);
                    return { user: udata, highlights: hdata, stories: sdata, posts: pdata };
                }
                igInfoForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const usrname = usernameInput.value.trim();
                    igNotif.style.display = 'none'; igResults.style.display = 'none';
                    disableButton(searchIgBtn);
                    if (!usrname) { showNotification('ig-info-notification', 'Username tidak boleh kosong!', 'error'); enableButton(searchIgBtn); return; }
                    showNotification('ig-info-notification', 'Mengambil data dari 4 endpoint... Mohon tunggu.', 'info');
                    try {
                        const hasil = await getUser(usrname);
                        const udata = hasil.user;
                        const jsonString = JSON.stringify(hasil, null, 2);
                        igResults.innerHTML = `
                            <img src="${udata.profile_pic_url}" alt="Profile Picture">
                            <h3>${udata.full_name || udata.username} ${udata.is_verified ? '<i class="fas fa-check-circle" style="color:var(--primary-color);"></i>' : ''}</h3>
                            <p><b>Username:</b> ${udata.username}</p>
                            <p><b>Bio:</b> ${udata.biography ? udata.biography.replace(/\n/g, '<br>') : '-'}</p>
                            <p><b>Followers:</b> ${(udata.follower_count || 0).toLocaleString('id-ID')}</p>
                            <p><b>Following:</b> ${(udata.following_count || 0).toLocaleString('id-ID')}</p>
                            <p><b>Posts:</b> ${udata.media_count || 0}</p>
                            <p><b>Private:</b> ${udata.is_private ? 'Ya' : 'Tidak'}</p>
                            <pre>${jsonString}</pre>
                        `;
                        igResults.style.display = 'block';
                        igNotif.style.display = 'none';
                        addCopyButton(igResults, jsonString);
                    } catch (err) {
                        showNotification('ig-info-notification', `âš ï¸ Error: ${err.message}`, 'error');
                    } finally {
                        enableButton(searchIgBtn);
                    }
                });
            })();
            
            // --- 3.3. Logika iPhone Quoted Chat ---
            (function() {
                const iqcForm = document.getElementById('iqc-form');
                if (!iqcForm) return;
                const generateIqcBtn = document.getElementById('generate-iqc-btn');
                const iqcTextInput = document.getElementById('iqc-text');
                const iqcNotif = document.getElementById('iqc-notification');
                const iqcResults = document.getElementById('iqc-results');
                async function getBatteryPercent() {
                    try {
                        if (navigator.getBattery) { const battery = await navigator.getBattery(); return Math.round(battery.level * 100); }
                        else { return Math.floor(Math.random() * 100) + 1; }
                    } catch (e) { return Math.floor(Math.random() * 100) + 1; }
                }
                iqcForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const text = iqcTextInput.value.trim();
                    iqcNotif.style.display = 'none'; iqcResults.style.display = 'none';
                    disableButton(generateIqcBtn);
                    if (!text) { showNotification('iqc-notification', 'Teks pesan tidak boleh kosong!', 'error'); enableButton(generateIqcBtn); return; }
                    showNotification('iqc-notification', 'Membuat gambar...', 'info');
                    try {
                        const d = new Date();
                        const time = new Date(d.getTime() + 7*3600000).toLocaleTimeString('id-ID',{hour:'2-digit',minute:'2-digit',hour12:false});
                        const battery = await getBatteryPercent();
                        const apiUrl = `https://brat.siputzx.my.id/iphone-quoted?time=${encodeURIComponent(time)}&messageText=${encodeURIComponent(text)}&carrierName=INDOSAT%20OORE...&batteryPercentage=${battery}&signalStrength=4&emojiStyle=apple`;
                        const img = new Image(); img.src = apiUrl; img.alt = "Generated iPhone Quote";
                        img.onload = () => {
                            iqcResults.innerHTML = '';
                            const link = document.createElement('a');
                            link.href = apiUrl; link.target = "_blank"; link.title = "Klik untuk lihat gambar penuh";
                            link.appendChild(img);
                            iqcResults.appendChild(link);
                            iqcResults.style.display = 'block';
                            iqcNotif.style.display = 'none';
                            enableButton(generateIqcBtn);
                        };
                        img.onerror = () => { throw new Error('API gagal membuat gambar.'); };
                    } catch (err) {
                        showNotification('iqc-notification', `âš ï¸ Error: ${err.message}`, 'error');
                        enableButton(generateIqcBtn);
                    }
                });
            })();
            
            // --- 3.4. Logika Spotify Downloader ---
            (function() {
                const spotifyForm = document.getElementById('spotify-form');
                if (!spotifyForm) return;
                const spotifyDlBtn = document.getElementById('spotify-dl-btn');
                const spotifyUrlInput = document.getElementById('spotify-url');
                const spotifyNotif = document.getElementById('spotify-notification');
                const spotifyResults = document.getElementById('spotify-results');
                const spotifyResultsList = document.getElementById('spotify-results-list');
                async function spotdl(url) {
                    const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent('https://www.acethinker.com/downloader/api/jdownv2.php?url=' + encodeURIComponent(url))}`;
                    const res = await fetch(proxyUrl, { headers: { 'Accept': 'application/json, text/plain, */*' } });
                    if (!res.ok) throw new Error('Gagal menghubungi server proxy.');
                    const proxyData = await res.json();
                    const jsonText = proxyData.contents;
                    let data;
                    try { data = JSON.parse(jsonText); } 
                    catch (e) { throw new Error('URL tidak valid atau API AceThinker berubah.'); }
                    if (!data || !data.data) { throw new Error('Tidak ada data dikembalikan oleh API.'); }
                    return data.data;
                }
                spotifyForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const url = spotifyUrlInput.value.trim();
                    spotifyNotif.style.display = 'none'; spotifyResults.style.display = 'none';
                    disableButton(spotifyDlBtn);
                    if (!url) { showNotification('spotify-notification', 'URL Spotify tidak boleh kosong!', 'error'); enableButton(spotifyDlBtn); return; }
                    showNotification('spotify-notification', 'Mengambil data dari AceThinker...', 'info');
                    try {
                        const info = await spotdl(url);
                        let output = `
                            <li><strong>Judul:</strong> <span>${info.title || 'Tidak diketahui'}</span></li>
                            <li><strong>Artis:</strong> <span>${info.artist || 'Tidak diketahui'}</span></li>
                        `;
                        if (info.sd_url) {
                            output += `<li><strong>Link:</strong> <span><a href="${info.sd_url}" target="_blank">Klik di sini untuk download MP3</a></span></li>`;
                        } else {
                            output += `<li><strong>Link:</strong> <span>âŒ Tidak ada link download MP3 ditemukan.</span></li>`;
                        }
                        spotifyResultsList.innerHTML = output;
                        spotifyResults.style.display = 'block';
                        spotifyNotif.style.display = 'none';
                    } catch (err) {
                        showNotification('spotify-notification', `âš ï¸ Error: ${err.message}`, 'error');
                    } finally {
                        enableButton(spotifyDlBtn);
                    }
                });
            })();
            
            // --- 3.5. Logika MP3 Player ---
            (function() {
                const audioUpload = document.getElementById('audio-upload');
                if (!audioUpload) return;
                const audioPlayer = document.getElementById('audio-player');
                const playPauseBtn = document.getElementById('play-pause-btn');
                const volumeSlider = document.getElementById('volume-slider');
                const songTitle = document.getElementById('song-title');
                const canvas = document.getElementById('visualizer-canvas');
                const canvasCtx = canvas.getContext('2d');
                let audioContext, analyser, source, dataArray, bufferLength, animationFrameId;
                function initAudioContext() {
                    if (!audioContext) {
                        audioContext = new (window.AudioContext || window.webkitAudioContext)();
                        analyser = audioContext.createAnalyser();
                        analyser.fftSize = 256;
                        bufferLength = analyser.frequencyBinCount;
                        dataArray = new Uint8Array(bufferLength);
                    }
                }
                function drawVisualizer() {
                    animationFrameId = requestAnimationFrame(drawVisualizer);
                    analyser.getByteFrequencyData(dataArray);
                    canvasCtx.fillStyle = getComputedStyle(document.body).getPropertyValue('--input-bg').trim() || '#1a1a1a';
                    canvasCtx.fillRect(0, 0, canvas.width, canvas.height);
                    const barWidth = (canvas.width / bufferLength) * 2.5;
                    let barHeight; let x = 0;
                    const primaryColor = getComputedStyle(document.body).getPropertyValue('--primary-color').trim() || '#cccccc';
                    for(let i = 0; i < bufferLength; i++) {
                        barHeight = dataArray[i] / 2;
                        canvasCtx.fillStyle = primaryColor;
                        canvasCtx.fillRect(x, canvas.height - barHeight, barWidth, barHeight);
                        x += barWidth + 1;
                    }
                }
                audioUpload.addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    if (!file) return;
                    initAudioContext();
                    if (animationFrameId) { cancelAnimationFrame(animationFrameId); }
                    const fileURL = URL.createObjectURL(file);
                    audioPlayer.src = fileURL;
                    songTitle.textContent = file.name;
                    if (!source) {
                        source = audioContext.createMediaElementSource(audioPlayer);
                        source.connect(analyser);
                        analyser.connect(audioContext.destination);
                    }
                    audioPlayer.play();
                    drawVisualizer();
                });
                audioPlayer.addEventListener('play', () => {
                    playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
                    if (audioContext && audioContext.state === 'suspended') { audioContext.resume(); }
                });
                audioPlayer.addEventListener('pause', () => { playPauseBtn.innerHTML = '<i class="fas fa-play"></i>'; });
                playPauseBtn.addEventListener('click', () => {
                    if (audioPlayer.paused) { audioPlayer.play(); } else { audioPlayer.pause(); }
                });
                volumeSlider.addEventListener('input', (e) => { audioPlayer.volume = e.target.value; });
            })();
            
            // --- 3.6. Logika Lunara Uploader ---
            (function() {
                const lunaraForm = document.getElementById('lunara-form');
                if (!lunaraForm) return;
                const lunaraUploadBtn = document.getElementById('lunara-upload-btn');
                const lunaraFileInput = document.getElementById('lunara-file-input');
                const lunaraPermanentCheck = document.getElementById('lunara-permanent-check');
                const lunaraNotif = document.getElementById('lunara-notification');
                const lunaraResults = document.getElementById('lunara-results');
                const lunaraResultsList = document.getElementById('lunara-results-list');
                lunaraForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const file = lunaraFileInput.files[0];
                    const permanent = lunaraPermanentCheck.checked;
                    lunaraNotif.style.display = 'none'; lunaraResults.style.display = 'none';
                    disableButton(lunaraUploadBtn);
                    if (!file) { showNotification('lunara-notification', 'Pilih file dulu sebelum upload!', 'error'); enableButton(lunaraUploadBtn); return; }
                    showNotification('lunara-notification', 'â˜ï¸ Mengunggah ke Lunara...', 'info');
                    try {
                        const formData = new FormData();
                        formData.append("file", file);
                        if (permanent) { formData.append("permanent", "true"); } 
                        else { formData.append("expire_value", "24"); formData.append("expire_unit", "hours"); }
                        const res = await fetch("https://lunara.drizznesiasite.biz.id/upload", { method: "POST", body: formData });
                        if (!res.ok) throw new Error("Gagal upload, server tidak merespons.");
                        const data = await res.json();
                        if (!data.file_url) throw new Error("Tidak ada URL di respons server.");
                        lunaraResultsList.innerHTML = `
                            <li><strong>File:</strong> <span>${file.name}</span></li>
                            <li><strong>Status:</strong> <span>${permanent ? "Permanent" : "24 Jam"}</span></li>
                            <li><strong>URL:</strong> <span><a href="${data.file_url}" target="_blank">${data.file_url}</a></span></li>
                        `;
                        lunaraResults.style.display = 'block';
                        lunaraNotif.style.display = 'none';
                        addCopyButton(lunaraResults, data.file_url);
                    } catch (err) {
                        showNotification('lunara-notification', `âŒ Error: ${err.message}`, 'error');
                    } finally {
                        enableButton(lunaraUploadBtn);
                    }
                });
            })();
            
            // --- 3.7. Logika Roblox Stalker ---
            (function() {
                const robloxForm = document.getElementById('roblox-form');
                if (!robloxForm) return;
                const robloxApiBase = "https://api.zenzxz.my.id/api/stalker/roblox?user=";
                const robloxResultEl = document.getElementById('roblox-result');
                const robloxUsernameInput = document.getElementById('roblox-username');
                const robloxBtn = document.getElementById('roblox-btn');
                const robloxClearBtn = document.getElementById('roblox-clear-btn');
                const robloxNotif = document.getElementById('roblox-notification');
                robloxClearBtn.addEventListener('click', ()=>{
                  robloxUsernameInput.value='';
                  robloxResultEl.innerHTML = '<p class="roblox-note">Hasil akan muncul di sini setelah kamu klik <b>Stalk</b>.</p>';
                  robloxResultEl.style.display = 'none';
                  robloxNotif.style.display = 'none';
                });
                robloxForm.addEventListener('submit', async (ev)=>{
                  ev.preventDefault();
                  const username = robloxUsernameInput.value.trim();
                  if (!username) {
                    showNotification('roblox-notification', 'Isi username dulu bro!', 'error');
                    return;
                  }
                  disableButton(robloxBtn);
                  robloxNotif.style.display = 'none';
                  robloxResultEl.style.display = 'none';
                  showNotification('roblox-notification', 'â³ Mengambil data Roblox...', 'info');
                  try {
                    let res = await fetch(robloxApiBase + encodeURIComponent(username));
                    if (!res.ok) {
                      console.warn('Direct fetch failed, trying proxy...');
                      const proxy = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(robloxApiBase + encodeURIComponent(username));
                      res = await fetch(proxy);
                      if (!res.ok) throw new Error('Gagal menghubungi API (proxy juga gagal).');
                    }
                    const json = await res.json();
                    const data = json?.data;
                    if (!data) { throw new Error('Tidak ditemukan data Roblox untuk user tersebut!'); }
                    robloxNotif.style.display = 'none';
                    const user = data.basic || {};
                    const displayName = user.displayName || user.display_name || '-';
                    const name = user.name || user.username || '-';
                    const id = user.id || '-';
                    const description = user.description || '-';
                    const created = user.created ? new Date(user.created).toLocaleString('id-ID', { dateStyle: 'medium', timeStyle: 'short' }) : '-';
                    const isBanned = !!user.isBanned;
                    const status = data.status || '-';
                    const presence = (data.presence && data.presence.userPresences && data.presence.userPresences[0] && data.presence.userPresences[0].lastLocation) || 'Tidak diketahui';
                    const social = data.social || {};
                    const friendsCount = (social.friends && social.friends.count) || 0;
                    const followersCount = (social.followers && social.followers.count) || 0;
                    const followingCount = (social.following && social.following.count) || 0;
                    const groups = (data.groups && data.groups.list && data.groups.list.data) ? data.groups.list.data.slice(0,5) : [];
                    const avatarUrl = user.avatar || user.image || user.icon || '';
                    const topGroupsHtml = groups.length ? groups.map((g,i)=>`<div>${i+1}. <b>${escapeHtml(g.group?.name||'-')}</b> â€” ${escapeHtml(g.role?.name||'-')}</div>`).join('') : '<div>Tidak ada grup ditemukan.</div>';
                    robloxResultEl.innerHTML = `
                      <div class="roblox-grid">
                        <div class="roblox-avatar">${ avatarUrl ? `<img src="${escapeHtml(avatarUrl)}" alt="avatar">` : `<div style="padding:12px; opacity: 0.7;">No Avatar</div>` }</div>
                        <div class="roblox-meta">
                          <h4>${escapeHtml(displayName)} <small>(@${escapeHtml(name)})</small></h4>
                          <p>ðŸ§© <b>User ID:</b> ${escapeHtml(id)}</p>
                          <p>ðŸ•’ <b>Dibuat:</b> ${escapeHtml(created)}</p>
                          <p>ðŸ“œ <b>Deskripsi:</b> ${escapeHtml(description) || '<i>Tidak ada deskripsi.</i>'}</p>
                          <p>ðŸš« <b>Banned:</b> ${isBanned ? '<span class="roblox-error">Ya</span>' : '<span class="roblox-ok">Tidak</span>'}</p>
                          <p>ðŸŒ <b>Status:</b> ${escapeHtml(status)}</p>
                          <p>ðŸ“ <b>Aktivitas:</b> ${escapeHtml(presence)}</p>
                          <div class="roblox-stats">
                            <div class="roblox-stat">ðŸ‘¥ Teman: ${friendsCount}</div>
                            <div class="roblox-stat">ðŸ‘£ Pengikut: ${followersCount}</div>
                            <div class="roblox-stat">ðŸ” Mengikuti: ${followingCount}</div>
                          </div>
                        </div>
                      </div>
                      <div class="roblox-groups">
                        <h5>ðŸ·ï¸ Top Grup yang Diikuti:</h5>
                        ${topGroupsHtml}
                      </div>
                      <div>
                        <details>
                          <summary>Tampilkan JSON mentah</summary>
                          <pre>${escapeHtml(JSON.stringify(data, null, 2))}</pre>
                        </details>
                      </div>
                    `;
                    robloxResultEl.style.display = 'block';
                    addCopyButton(robloxResultEl, JSON.stringify(data, null, 2));
                  } catch (err) {
                    console.error(err);
                    showNotification('roblox-notification', `âš ï¸ Error: ${escapeHtml(err.message || String(err))}`, 'error');
                  } finally {
                    enableButton(robloxBtn, '<i class="fas fa-search"></i> Stalk');
                  }
                });
            })();
            
            // --- 3.8. Logika Remove Background ---
            (function() {
                const rembgForm = document.getElementById('rembg-form');
                if (!rembgForm) return;
                const rembgBtn = document.getElementById('rembg-btn');
                const rembgFileInput = document.getElementById('rembg-file-input');
                const rembgApiKeyInput = document.getElementById('rembg-api-key');
                const rembgNotif = document.getElementById('rembg-notification');
                const rembgResultsBox = document.getElementById('rembg-results');
                const rembgResultImg = document.getElementById('rembg-result-img');
                
                rembgForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const file = rembgFileInput.files[0];
                    const API_KEY = rembgApiKeyInput.value.trim();
                    rembgNotif.style.display = 'none';
                    rembgResultsBox.style.display = 'none';
                    disableButton(rembgBtn);
                    if (!file) { showNotification('rembg-notification', 'Pilih gambar dulu!', 'error'); enableButton(rembgBtn); return; }
                    if (!API_KEY) { showNotification('rembg-notification', 'API Key Remove.bg tidak boleh kosong!', 'error'); enableButton(rembgBtn); return; }
                    showNotification('rembg-notification', 'â³ Memproses... Ini mungkin butuh waktu.', 'info');
                    rembgResultImg.src = '';
                    const formData = new FormData();
                    formData.append('image_file', file);
                    try {
                        const res = await fetch("https://api.remove.bg/v1.0/removebg", {
                            method: "POST", headers: { "X-Api-Key": API_KEY }, body: formData
                        });
                        if (!res.ok) {
                            let errorMsg = "Gagal memproses gambar";
                            try { const errorData = await res.json(); errorMsg = errorData?.errors?.[0]?.title || errorMsg; } catch(jsonError) {}
                            throw new Error(errorMsg);
                        }
                        const blob = await res.blob();
                        const url = URL.createObjectURL(blob);
                        rembgResultImg.src = url;
                        rembgResultsBox.style.display = 'block';
                        rembgNotif.style.display = 'none';
                    } catch (e) {
                        showNotification('rembg-notification', "âŒ Error: " + e.message, 'error');
                    } finally {
                        enableButton(rembgBtn);
                    }
                });
            })();
            
            // --- 3.9. Logika Web Deployer & APK Builder ---
            (function() {
                const deployerForm = document.getElementById('deployer-form');
                if (!deployerForm) return;
                
                // Form Inputs
                const deployerBtn = document.getElementById('deployer-btn');
                const vercelTokenInput = document.getElementById('vercel-token');
                const siteNameInput = document.getElementById('site-name');
                const deployerFileInput = document.getElementById('deployer-file-input');
                const saveTokenCheck = document.getElementById('save-token-check');
                const resetTokenBtn = document.getElementById('reset-token-btn');
                
                // APK Options
                const buildApkCheck = document.getElementById('deployer-build-apk-check');
                const apkOptionsDiv = document.getElementById('deployer-apk-options');
                const apkAppNameInput = document.getElementById('deployer-appName');
                const apkIconUrlInput = document.getElementById('deployer-iconUrl');
                
                // Results
                const deployerNotif = document.getElementById('deployer-notification');
                const deployerResults = document.getElementById('deployer-results');
                const deployerResultsList = document.getElementById('deployer-results-list');
                
                // Muat token dari localStorage
                const savedToken = localStorage.getItem('xvct-vercel-token');
                if (savedToken) {
                    vercelTokenInput.value = savedToken;
                    saveTokenCheck.checked = true;
                }
                
                // Simpan token
                saveTokenCheck.addEventListener('change', () => {
                    if (saveTokenCheck.checked) {
                        localStorage.setItem('xvct-vercel-token', vercelTokenInput.value.trim());
                    } else {
                        localStorage.removeItem('xvct-vercel-token');
                    }
                });
                vercelTokenInput.addEventListener('input', () => {
                    if (saveTokenCheck.checked) {
                        localStorage.setItem('xvct-vercel-token', vercelTokenInput.value.trim());
                    }
                });
                
                // Reset token
                resetTokenBtn.addEventListener('click', () => {
                    localStorage.removeItem('xvct-vercel-token');
                    vercelTokenInput.value = '';
                    saveTokenCheck.checked = false;
                });
                
                // Tampilkan/sembunyikan opsi APK
                buildApkCheck.addEventListener('change', () => {
                    apkOptionsDiv.style.display = buildApkCheck.checked ? 'block' : 'none';
                });

                // Helper: Upload ikon dari ZIP ke Lunara
                async function uploadIconFromZip(file) {
                    showNotification('deployer-notification', 'â˜ï¸ Auto-deteksi: Mengunggah ikon ke Lunara...', 'info');
                    try {
                        const formData = new FormData();
                        formData.append("file", file);
                        formData.append("permanent", "true");
                        const res = await fetch("https://lunara.drizznesiasite.biz.id/upload", { method: "POST", body: formData });
                        if (!res.ok) throw new Error("Gagal auto-upload ikon ke Lunara.");
                        const data = await res.json();
                        if (!data.file_url) throw new Error("Lunara tidak merespon dengan URL.");
                        showNotification('deployer-notification', 'â˜ï¸ Ikon berhasil di-upload!', 'info');
                        return data.file_url;
                    } catch (err) {
                        throw err;
                    }
                }
                
                // Helper: Build APK
                async function buildApk(siteUrl, appName, iconUrl) {
                    showNotification('deployer-notification', 'âš™ï¸ Memulai build APK...', 'info');
                    try {
                        const apiUrl = 'https://api.fikmydomainsz.xyz/tools/toapp/build-complete' +
                          '?url=' + encodeURIComponent(siteUrl) +
                          '&email=' + encodeURIComponent('user@example.com') + // Email bisa dummy
                          '&appName=' + encodeURIComponent(appName) +
                          '&appIcon=' + encodeURIComponent(iconUrl);
                        
                        const controller = new AbortController();
                        const timeoutId = setTimeout(() => controller.abort(), 374600); // ~6 min timeout
                        const res = await fetch(apiUrl, { signal: controller.signal });
                        clearTimeout(timeoutId);
                        
                        if (!res.ok) throw new Error(`API Web2APK gagal (HTTP ${res.status})`);
                        const job = await res.json();
                        if (!job.status) throw new Error(job.error || 'Build APK gagal.');
                        return job;
                    } catch (err) {
                        throw err;
                    }
                }
                
                // Main Submit Logic
                deployerForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    const vercelToken = vercelTokenInput.value.trim();
                    const siteName = siteNameInput.value.trim();
                    const file = deployerFileInput.files[0];
                    const wantsApk = buildApkCheck.checked;
                    const apkAppName = apkAppNameInput.value.trim();
                    let apkIconUrl = apkIconUrlInput.value.trim();
                    
                    deployerNotif.style.display = 'none';
                    deployerResults.style.display = 'none';
                    disableButton(deployerBtn);
                    
                    if (!vercelToken || !siteName || !file) {
                        showNotification('deployer-notification', 'Token, Nama Project, dan File wajib diisi!', 'error');
                        enableButton(deployerBtn);
                        return;
                    }
                    
                    let htmlText;
                    let deployUrl = "";
                    let apkResultHtml = "";
                    
                    try {
                        showNotification('deployer-notification', 'Membaca file...', 'info');
                        
                        // 1. Baca file & auto-detek icon
                        if (file.type === 'application/zip') {
                            const zip = await JSZip.loadAsync(file);
                            let htmlEntry = zip.file("index.html") || zip.file(/.+\.html$/i)[0];
                            if (!htmlEntry) throw new Error("Tidak ada file .html ditemukan di dalam .zip");
                            htmlText = await htmlEntry.async("string");
                            
                            // Auto-detek icon JIKA user mau APK dan BELUM isi URL
                            if (wantsApk && !apkIconUrl) {
                                showNotification('deployer-notification', 'Mencari icon di .zip...', 'info');
                                let iconEntry = zip.file("app.png") || zip.file("app.jpg") || zip.file("icon.png") || zip.file("icon.jpg");
                                if (iconEntry) {
                                    const iconBlob = await iconEntry.async("blob");
                                    const iconFile = new File([iconBlob], iconEntry.name, { type: iconBlob.type });
                                    apkIconUrl = await uploadIconFromZip(iconFile); // Upload ke Lunara
                                } else {
                                    throw new Error("Build APK dicentang, tapi Icon URL kosong DAN tidak ada 'app.png'/'app.jpg' di .zip.");
                                }
                            }
                        } else if (file.type === 'text/html') {
                            htmlText = await file.text();
                        } else {
                            throw new Error("File harus .html atau .zip");
                        }
                        
                        if (wantsApk && !apkAppName) throw new Error("Nama Aplikasi wajib diisi untuk build APK.");
                        if (wantsApk && !apkIconUrl) throw new Error("Icon URL wajib diisi (atau sediakan di .zip).");

                        // 2. Buat Project Vercel
                        showNotification('deployer-notification', 'Membuat project di Vercel...', 'info');
                        const projectRes = await fetch("https://api.vercel.com/v10/projects", {
                            method: "POST",
                            headers: { "Authorization": `Bearer ${vercelToken}`, "Content-Type": "application/json" },
                            body: JSON.stringify({ name: siteName, framework: null })
                        });
                        const projectData = await projectRes.json();
                        if (!projectRes.ok && projectData.error.code !== 'project_already_exists') {
                             throw new Error(`Vercel (Project): ${projectData.error?.message || 'Gagal buat project'}`);
                        }
                        
                        // 3. Deploy ke Vercel
                        showNotification('deployer-notification', 'Mendeploy file ke Vercel...', 'info');
                        const payload = {
                            name: siteName, project: siteName, target: "production",
                            files: [{ file: "index.html", data: htmlText }],
                            projectSettings: { framework: null }
                        };
                        const deployRes = await fetch("https://api.vercel.com/v13/deployments", {
                            method: "POST",
                            headers: { "Authorization": `Bearer ${vercelToken}`, "Content-Type": "application/json" },
                            body: JSON.stringify(payload)
                        });
                        const deployData = await deployRes.json();
                        
                        if (!deployData.url) {
                            throw new Error(`Vercel (Deploy): ${deployData.error?.message || "Gagal deploy."}`);
                        }
                        
                        deployUrl = `https://s${deployData.url}`;
                        
                        // 4. Build APK (Jika dicentang)
                        if (wantsApk) {
                            try {
                                const apkJob = await buildApk(deployUrl, apkAppName, apkIconUrl);
                                apkResultHtml = `
                                    <li><strong>APK Link:</strong> <span><a href="${apkJob.downloadUrl}" target="_blank">Download APK</a></span></li>
                                    <li><strong>Keystore:</strong> <span><pre>${`storePass : ${apkJob.storePass}\nkeyPass   : ${apkJob.keyPass}\nkeySha    : ${apkJob.keySha}\npackage   : ${apkJob.packageName}`}</pre></span></li>
                                `;
                            } catch (apkErr) {
                                apkResultHtml = `<li><strong>APK Link:</strong> <span><span class="roblox-error">Gagal Build: ${apkErr.message}</span></span></li>`;
                            }
                        }
                        
                        // 5. Tampilkan Hasil
                        deployerResultsList.innerHTML = `
                            <li><strong>Web URL:</strong> <span><a href="${deployUrl}" target="_blank">${deployUrl}</a></span></li>
                            <li><strong>Status:</strong> <span><span class="roblox-ok">${deployData.readyState}</span></span></li>
                            <li><strong>Dibuat:</strong> <span>${new Date(deployData.createdAt).toLocaleString('id-ID', { dateStyle: 'medium', timeStyle: 'short' })}</span></li>
                            ${apkResultHtml}
                        `;
                        deployerResults.style.display = 'block';
                        deployerNotif.style.display = 'none';
                        addCopyButton(deployerResults, deployUrl);
                        
                    } catch (err) {
                        showNotification('deployer-notification', `âŒ Error: ${err.message}`, 'error');
                    } finally {
                        enableButton(deployerBtn);
                    }
                });
            })();
            
            // --- 3.10. TIKTOK DOWNLOADER (REMAKE) ---
            (function() {
                const form = document.getElementById('tiktok-form');
                if (!form) return;
                
                const urlInput = document.getElementById('tiktok-url');
                const btn = document.getElementById('tiktok-btn');
                const loading = document.getElementById('tiktok-loading');
                const result = document.getElementById('tiktok-result');
                const notif = document.getElementById('tiktok-notification');
                
                form.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const url = urlInput.value.trim();
                    if (!url) {
                        showNotification('tiktok-notification', 'Masukkan link TikTok!', 'error');
                        return;
                    }

                    // Gunakan helper disableButton
                    disableButton(btn);
                    loading.style.display = 'block';
                    result.style.display = 'none';
                    notif.style.display = 'none';

                    try {
                        const api = `https://api.nvidiabotz.xyz/download/tiktok?url=${encodeURIComponent(url)}`;
                        const res = await fetch(api);
                        const json = await res.json();

                        if (!json.status) throw new Error(json.message || 'Gagal mengambil data');

                        const { video_hd, video_sd, mp3, thumbnail, title } = json.result;

                        // Tampilkan hasil lengkap
                        document.getElementById('tiktok-thumb').src = thumbnail;
                        document.getElementById('tiktok-title').textContent = title;
                        document.getElementById('tiktok-hd').href = video_hd;
                        document.getElementById('tiktok-sd').href = video_sd;
                        document.getElementById('tiktok-mp3').href = mp3;
                        result.style.display = 'block';
                        
                        showNotification('tiktok-notification', 'Sukses! Download HD akan dimulai otomatis...', 'success');

                        // Auto-download HD (menjaga fitur dari kode Anda)
                        setTimeout(() => {
                            const a = document.createElement('a');
                            a.href = video_hd;
                            a.download = 'tiktok-hd.mp4';
                            a.style.display = 'none';
                            document.body.appendChild(a);
                            a.click();
                            document.body.removeChild(a);
                        }, 1000); // Kasih jeda 1 detik

                    } catch (e) {
                        showNotification('tiktok-notification', e.message || 'Server error', 'error');
                    } finally {
                        // Gunakan helper enableButton
                        enableButton(btn); // Otomatis kembali ke '<i class="fas fa-download"></i> Download'
                        loading.style.display = 'none';
                    }
                });
            })();
            
        });
    </script>

</body>
</html>
